(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"./src/components/pages/UsersDetailPage.jsx":
/*!**************************************************************!*\
  !*** ./src/components/pages/UsersDetailPage.jsx + 5 modules ***!
  \**************************************************************/
/*! exports provided: default */
/*! all exports used */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@fortawesome/free-solid-svg-icons/index.es.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@fortawesome/react-fontawesome/index.es.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/atoms/LinkButton.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/atoms/TooltipComponent.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/contexts/AuthContext.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/contexts/ProfileContext.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/modules/axios.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/modules/env.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/modules/utils.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/molecules/Loader.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/components/organisms/List/ImageList.jsx */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react-router-dom/esm/react-router-dom.js (<- Module is referenced from these modules with unsupported syntax: ./node_modules/react-router-cache-route/lib/index.js (referenced with cjs require)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react/index.js (<- Module is not an ECMAScript module) */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__("./node_modules/react/index.js");\nvar react_default = /*#__PURE__*/__webpack_require__.n(react);\n\n// EXTERNAL MODULE: ./node_modules/react-router-dom/esm/react-router-dom.js\nvar react_router_dom = __webpack_require__("./node_modules/react-router-dom/esm/react-router-dom.js");\n\n// EXTERNAL MODULE: ./src/components/contexts/ProfileContext.jsx\nvar ProfileContext = __webpack_require__("./src/components/contexts/ProfileContext.jsx");\n\n// EXTERNAL MODULE: ./src/components/modules/axios.js\nvar axios = __webpack_require__("./src/components/modules/axios.js");\n\n// EXTERNAL MODULE: ./src/components/modules/env.js\nvar env = __webpack_require__("./src/components/modules/env.js");\n\n// EXTERNAL MODULE: ./src/components/modules/utils.js\nvar utils = __webpack_require__("./src/components/modules/utils.js");\n\n// EXTERNAL MODULE: ./src/components/molecules/Loader.jsx\nvar Loader = __webpack_require__("./src/components/molecules/Loader.jsx");\n\n// EXTERNAL MODULE: ./node_modules/@fortawesome/free-solid-svg-icons/index.es.js\nvar index_es = __webpack_require__("./node_modules/@fortawesome/free-solid-svg-icons/index.es.js");\n\n// EXTERNAL MODULE: ./node_modules/@fortawesome/react-fontawesome/index.es.js\nvar react_fontawesome_index_es = __webpack_require__("./node_modules/@fortawesome/react-fontawesome/index.es.js");\n\n// EXTERNAL MODULE: ./src/components/atoms/LinkButton.jsx\nvar LinkButton = __webpack_require__("./src/components/atoms/LinkButton.jsx");\n\n// EXTERNAL MODULE: ./src/components/contexts/AuthContext.jsx\nvar AuthContext = __webpack_require__("./src/components/contexts/AuthContext.jsx");\n\n// CONCATENATED MODULE: ./src/components/molecules/ProfileButtonGroup.jsx\n\n\n\n\n\n\n\n\n\nconst ProfileButtonGroup = props => {\n  const {\n    username,\n    favoriteListKey\n  } = props;\n  const authState = Object(AuthContext["d" /* useAuthState */])();\n  const [favoritesNum, setFavoritesNum] = Object(react["useState"])(0);\n  const [maxFavoritesNum, setMaxFavoritesNum] = Object(react["useState"])(0);\n  Object(axios["a" /* useAxios */])(Object(utils["a" /* URLJoin */])(env["d" /* BASE_URL */], "favorites/info/"), "get", {\n    thenCallback: res => {\n      const _resData = Object(utils["g" /* deepCvtKeyFromSnakeToCamel */])(res.data);\n\n      setFavoritesNum(_resData.favoritesNum);\n      setMaxFavoritesNum(_resData.maxFavoritesNum);\n    },\n    token: authState.token,\n    shouldRequestDidMount: true\n  });\n  return /*#__PURE__*/react_default.a.createElement("div", {\n    className: "row mt-4 mt-sm-5 mx-0 mx-sm-3 mx-md-0"\n  }, /*#__PURE__*/react_default.a.createElement(LinkButton["a" /* default */], {\n    to: {\n      pathname: `/users/${username}/`,\n      state: {\n        accessKey: favoriteListKey\n      }\n    },\n    className: `rounded-pill profile-mode-select-button active ${utils["u" /* isMobile */] ? "mobile" : ""} ${utils["w" /* isSmp */] ? "ml-0" : "ml-3"}`\n  }, /*#__PURE__*/react_default.a.createElement(react_fontawesome_index_es["a" /* FontAwesomeIcon */], {\n    icon: index_es["q" /* faFolder */],\n    className: "mr-2"\n  }), /*#__PURE__*/react_default.a.createElement("b", null, "\\u30DE\\u30A4\\u30D5\\u30A9\\u30EB\\u30C0"), /*#__PURE__*/react_default.a.createElement("div", {\n    className: "ml-2 px-1 rounded-pill profile-mode-select-button-badge"\n  }, /*#__PURE__*/react_default.a.createElement("b", null, favoritesNum), `/${maxFavoritesNum}`)));\n};\n\n/* harmony default export */ var molecules_ProfileButtonGroup = (ProfileButtonGroup);\n// EXTERNAL MODULE: ./src/components/organisms/List/ImageList.jsx\nvar ImageList = __webpack_require__("./src/components/organisms/List/ImageList.jsx");\n\n// EXTERNAL MODULE: ./src/components/atoms/TooltipComponent.jsx\nvar TooltipComponent = __webpack_require__("./src/components/atoms/TooltipComponent.jsx");\n\n// CONCATENATED MODULE: ./src/components/atoms/AvatarSequence.jsx\n\n\n\n/** アバター等のアイコンを連続に表示(ex. 推しメン一覧)\r\n *  要素同士が少し重なり合い, カーソルを合わせると最前面に表示される.\r\n *  最もdirection("right"|"left")に存在するアイコンがデフォルトで最前面にくる.\r\n *  item: { url: string, imageUrl: string, alt: string, contentsNode?: Node, backgroundColor?: string }\r\n */\n\nconst AvatarSequence = props => {\n  const {\n    items = [],\n    diameter = 45\n    /* optional */\n    ,\n    direction = "left"\n    /* optional */\n\n  } = props;\n  const [listHover, setListHover] = Object(react["useState"])(Array(items.length).fill(false));\n\n  const setIsHover = (index, val) => {\n    const _listHover = [...listHover]; // trueをsetする時, 他itemsにfalseをsetする\n\n    if (val) {\n      _listHover.fill(false);\n    }\n\n    _listHover[index] = val;\n    setListHover(_listHover);\n  };\n\n  const wrapperDiameter = diameter * 1.14;\n  const coverPx = diameter * 0.27;\n  const isReverse = direction === "right";\n  return /*#__PURE__*/react_default.a.createElement("div", {\n    className: "d-flex"\n  }, items.map((item, i) => {\n    const _id = `avatar-sequence-item-${i}`;\n    return /*#__PURE__*/react_default.a.createElement("div", {\n      key: i,\n      id: _id,\n      className: "avatar-sequence-item",\n      style: {\n        position: "relative",\n        // hover時は最大値のitems.length\n        zIndex: listHover[i] ? items.length : items.length - i,\n        ...(isReverse ? {\n          order: -i,\n          left: coverPx * i\n        } : {\n          right: coverPx * i\n        })\n      },\n      onMouseEnter: () => {\n        setIsHover(i, true);\n      },\n      onMouseLeave: () => {\n        setIsHover(i, false);\n      }\n    }, /*#__PURE__*/react_default.a.createElement(TooltipComponent["a" /* default */], {\n      title: item.alt\n    }, /*#__PURE__*/react_default.a.createElement(react_router_dom["Link"], {\n      to: item.url\n    }, /*#__PURE__*/react_default.a.createElement("div", {\n      className: "rounded-circle avatar-sequence-image-wrapper d-flex justify-content-center align-items-center",\n      style: {\n        width: wrapperDiameter,\n        height: wrapperDiameter\n      }\n    }, /*#__PURE__*/react_default.a.createElement("div", {\n      className: "rounded-circle avatar-sequence-image-hover-wrapper",\n      style: {\n        width: diameter,\n        height: diameter,\n        ...(listHover[i] ? {\n          opacity: 0.2\n        } : {\n          opacity: 0\n        })\n      }\n    }), item.contentsNode ? /*#__PURE__*/react_default.a.createElement("div", {\n      className: "rounded-circle avatar-sequence-image d-flex justify-content-center align-items-center",\n      style: {\n        width: diameter,\n        height: diameter,\n        backgroundColor: item.backgroundColor ? item.backgroundColor : "white"\n      }\n    }, item.contentsNode) : /*#__PURE__*/react_default.a.createElement("img", {\n      className: "rounded-circle avatar-sequence-image",\n      width: diameter,\n      height: diameter,\n      style: {\n        width: diameter,\n        height: diameter\n      },\n      src: item.imageUrl,\n      alt: item.alt\n    })))));\n  }));\n};\n\n/* harmony default export */ var atoms_AvatarSequence = (AvatarSequence);\n// CONCATENATED MODULE: ./src/components/atoms/ProfileIcon.jsx\n\n\n\nconst ProfileIcon = props => {\n  const {\n    imageUrl,\n    size\n  } = props;\n  const imageSize = size ? size : utils["w" /* isSmp */] ? 49 : 60;\n  const imageWrapperSize = imageSize + imageSize / 9;\n  return /*#__PURE__*/react_default.a.createElement("div", {\n    className: "profile-icon-wrapper rounded-circle",\n    style: {\n      height: imageWrapperSize,\n      width: imageWrapperSize\n    }\n  }, /*#__PURE__*/react_default.a.createElement("img", {\n    className: "profile-icon-image rounded-circle",\n    src: imageUrl,\n    style: {\n      height: imageSize,\n      width: imageSize\n    }\n  }));\n};\n\n/* harmony default export */ var atoms_ProfileIcon = (ProfileIcon);\n// CONCATENATED MODULE: ./src/components/organisms/ProfileView.jsx\n\n\n\n\n\n\n\n\nconst ProfileView = props => {\n  const {\n    profile,\n    isMe\n  } = props;\n  const titleFontSize = utils["w" /* isSmp */] ? 16 : 26;\n  const favGroupsItems = (profile === null || profile === void 0 ? void 0 : profile.favGroups) ? profile.favGroups.map(group => {\n    var _GROUPS$group$groupId;\n\n    return {\n      url: `/images/${group.groupId}/`,\n      alt: group.name,\n      backgroundColor: (_GROUPS$group$groupId = env["n" /* GROUPS */][group.groupId]) === null || _GROUPS$group$groupId === void 0 ? void 0 : _GROUPS$group$groupId.color,\n      contentsNode: /*#__PURE__*/react_default.a.createElement("div", {\n        className: "saka-mark"\n      })\n    };\n  }) : [];\n\n  const geneFavMemberItem = propertyName => {\n    return profile[propertyName] ? {\n      url: `/images/${env["n" /* GROUPS */][profile[propertyName].belongingGroup].id}/${profile[propertyName].ct}/`,\n      imageUrl: profile[propertyName].image,\n      alt: profile[propertyName].fullKanji\n    } : {};\n  };\n\n  const favMemberSakuraItem = geneFavMemberItem("favMemberSakura");\n  const favMemberHinataItem = geneFavMemberItem("favMemberHinata");\n  return /*#__PURE__*/react_default.a.createElement("div", {\n    className: "my-2 my-sm-4"\n  }, /*#__PURE__*/react_default.a.createElement("div", {\n    className: "d-flex justify-content-center pb-3"\n  }, /*#__PURE__*/react_default.a.createElement("div", {\n    className: "d-flex justify-content-end align-items-end",\n    style: {\n      flex: 1\n    }\n  }, /*#__PURE__*/react_default.a.createElement(atoms_AvatarSequence, {\n    direction: "right",\n    items: [...favGroupsItems, ...(isMe ? [{\n      url: "/settings/fav-members/",\n      alt: "推しグループを編集する",\n      backgroundColor: "whitesmoke",\n      contentsNode: /*#__PURE__*/react_default.a.createElement(react_fontawesome_index_es["a" /* FontAwesomeIcon */], {\n        icon: index_es["z" /* faPlus */],\n        color: "gray"\n      })\n    }] : [])]\n  })), /*#__PURE__*/react_default.a.createElement("div", {\n    className: "mx-2"\n  }, /*#__PURE__*/react_default.a.createElement(atoms_ProfileIcon, {\n    imageUrl: profile.image\n  })), /*#__PURE__*/react_default.a.createElement("div", {\n    className: "d-flex align-items-end",\n    style: {\n      flex: 1\n    }\n  }, /*#__PURE__*/react_default.a.createElement(atoms_AvatarSequence, {\n    direction: "left",\n    items: [...(Object.keys(favMemberSakuraItem).length ? [favMemberSakuraItem] : []), ...(Object.keys(favMemberHinataItem).length ? [favMemberHinataItem] : []), ...(isMe ? [{\n      url: "/settings/fav-members/",\n      alt: "推しメンを編集する",\n      backgroundColor: "whitesmoke",\n      contentsNode: /*#__PURE__*/react_default.a.createElement(react_fontawesome_index_es["a" /* FontAwesomeIcon */], {\n        icon: index_es["z" /* faPlus */],\n        color: "gray"\n      })\n    }] : [])]\n  }))), /*#__PURE__*/react_default.a.createElement("div", {\n    className: "d-flex align-items-center flex-column"\n  }, /*#__PURE__*/react_default.a.createElement("h1", {\n    className: "profile-title pb-0 pb-sm-2 m-0 text-center",\n    style: {\n      fontSize: titleFontSize\n    }\n  }, profile.name), /*#__PURE__*/react_default.a.createElement("div", {\n    className: ""\n  }, "@", profile.username)));\n};\n\n/* harmony default export */ var organisms_ProfileView = (ProfileView);\n// CONCATENATED MODULE: ./src/components/templates/UsersDetailTemplate.jsx\n\n\n\n\n\n\n\n\nconst UserTemplate = props => {\n  const {\n    profile,\n    username,\n    isMe,\n    isLoading,\n    accessKey\n  } = props; // accessKeyがundefined以外で変化した時、FavoriteListを更新\n\n  const [userPageKey, setUserPageKey] = Object(react["useState"])(accessKey);\n  Object(react["useEffect"])(() => {\n    if (userPageKey !== accessKey && typeof accessKey !== "undefined") {\n      setUserPageKey(accessKey);\n    }\n  }, [accessKey]);\n  return /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, /*#__PURE__*/react_default.a.createElement("div", {\n    className: "container mt-3 text-muted",\n    style: {\n      height: utils["u" /* isMobile */] ? 130 : 130\n    }\n  }, isLoading ? /*#__PURE__*/react_default.a.createElement(Loader["b" /* HorizontalLoader */], null) : /*#__PURE__*/react_default.a.createElement(organisms_ProfileView, {\n    profile: profile,\n    isMe: isMe\n  })), isMe ? /*#__PURE__*/react_default.a.createElement(react_default.a.Fragment, null, /*#__PURE__*/react_default.a.createElement("div", {\n    className: "container-fluid mt-3 text-muted"\n  }, /*#__PURE__*/react_default.a.createElement(molecules_ProfileButtonGroup, {\n    username: username,\n    favoriteListKey: userPageKey,\n    key: userPageKey\n  })), /*#__PURE__*/react_default.a.createElement("div", {\n    className: "container-fluid text-muted mt-3 list-container-fluid favorite-images-container"\n  }, /*#__PURE__*/react_default.a.createElement(ImageList["b" /* default */], {\n    key: userPageKey,\n    type: "FAVORITE_IMAGES"\n  }))) : /*#__PURE__*/react_default.a.createElement("div", {\n    style: {\n      marginTop: 300\n    }\n  }));\n};\n\n/* harmony default export */ var UsersDetailTemplate = (Object(react_router_dom["withRouter"])(UserTemplate));\n// CONCATENATED MODULE: ./src/components/pages/UsersDetailPage.jsx\n\n\n\n\n\n\n\n\nconst UserPage = props => {\n  var _location$state;\n\n  const profileState = Object(ProfileContext["d" /* useProfileState */])();\n  const params = Object(react_router_dom["useParams"])();\n  const [username] = Object(react["useState"])(Object(utils["e" /* checkNotCached */])(props) ? params.username : "");\n  const isMe = profileState.profile.username === username;\n  const [userProfile, setUserProfile] = Object(react["useState"])({});\n  const {\n    isLoading,\n    request\n  } = Object(axios["a" /* useAxios */])(Object(utils["a" /* URLJoin */])(env["d" /* BASE_URL */], "users/", username), "get", {\n    thenCallback: res => {\n      const _profile = Object(utils["g" /* deepCvtKeyFromSnakeToCamel */])(res.data);\n\n      setUserProfile(_profile);\n      Object(utils["H" /* updateMeta */])({\n        title: _profile.name,\n        description: ""\n      });\n    }\n  });\n  Object(react["useEffect"])(() => {\n    if (isMe) {\n      setUserProfile({ ...profileState.profile\n      });\n    } else {\n      request();\n    }\n  }, [username]);\n  Object(react["useEffect"])(() => {\n    if (isMe) {\n      setUserProfile({ ...profileState.profile\n      });\n    }\n  }, [profileState.profile]);\n  const location = Object(react_router_dom["useLocation"])();\n  return /*#__PURE__*/react_default.a.createElement(UsersDetailTemplate, {\n    isLoading: isLoading,\n    profile: userProfile,\n    username: username,\n    isMe: isMe,\n    accessKey: location === null || location === void 0 ? void 0 : (_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.accessKey // accessKeyが付与された遷移元の時、FavoriteListを更新\n\n  });\n};\n\n/* harmony default export */ var UsersDetailPage = __webpack_exports__["default"] = (Object(react_router_dom["withRouter"])(UserPage));\n\n//# sourceURL=webpack:///./src/components/pages/UsersDetailPage.jsx_+_5_modules?')}}]);