(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"./src/components/molecules/info/BlogSearchListInfo.jsx":function(e,t,s){"use strict";var a=s("./node_modules/react/index.js"),o=s.n(a),l=s("./src/components/modules/utils.js");class n extends o.a.Component{constructor(e){super(e)}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"card otapick-card2 "+(l.w?"smp mb-3 ":l.u?"mb-3 mt-1 ":"my-4 ")+this.props.group},o.a.createElement("div",{className:"card-body px-4 px-sm-5 py-4"},o.a.createElement("div",{className:"row mx-2 justify-content-between"},o.a.createElement("h2",{className:"my-auto d-flex align-items-center"},this.props.title?this.props.title:" ")),o.a.createElement("hr",{className:"info-hr"}),o.a.createElement("div",{className:"row justify-content-between"},o.a.createElement("div",{className:"col-12 col-md-6 col-lg-7 col-xl-8"},o.a.createElement("div",{className:"info-description my-1 my-sm-0"},"検索結果（",o.a.createElement("b",null,this.props.numOfHit),"件）"))))))}}t.a=n},"./src/components/templates/BlogViewTemplate.jsx":function(e,t,s){"use strict";s.r(t);var a=s("./node_modules/react/index.js"),o=s.n(a),l=s("./src/components/molecules/Headline.jsx"),n=s("./src/components/modules/utils.js"),i=s("./node_modules/axios/index.js"),r=s.n(i),c=s("./node_modules/react-router-dom/esm/react-router-dom.js"),m=s("./src/components/modules/env.js"),d=s("./node_modules/@fortawesome/free-solid-svg-icons/index.es.js"),p=s("./node_modules/@fortawesome/react-fontawesome/index.es.js"),u=s("./src/components/atoms/TooltipComponent.jsx");class h extends o.a.Component{constructor(e){super(e)}render(){let e;return Object.values(m.n).forEach(t=>{t.key===this.props.group&&(e=t.domain)}),o.a.createElement("div",{className:"card otapick-card2 "+(n.w?"smp mb-3 ":n.u?"mb-3 mt-1 ":"my-4 ")+this.props.group},o.a.createElement("div",{className:"card-body px-4 px-sm-5 py-4"},this.props.title.length>0?this.props.title.length>50?o.a.createElement("h3",{className:"smaller"},this.props.title):o.a.createElement("h3",null,this.props.title):o.a.createElement("h3",null," "),o.a.createElement("div",{className:"row download-info mt-3"},Object.keys(this.props.writer).length?o.a.createElement(c.Link,{to:this.props.writer.url.blogs,className:"info-description ml-3 small "+this.props.group},this.props.writer.name?this.props.writer.name:" "):o.a.createElement(c.Link,{to:"",className:"info-description ml-3 small "+this.props.group}," "),o.a.createElement("p",{className:"info-description ml-3 small mb-0"},this.props.postDate)),o.a.createElement("hr",{className:"info-hr"}),o.a.createElement("div",{className:"row ml-2 ml-sm-3"},o.a.createElement("div",{className:"row col-12 col-sm-7 col-md-8 col-lg-9 col-xl-10 info-description"},o.a.createElement("div",{className:"d-flex align-items-center"},o.a.createElement(u.a,{title:"閲覧数"},o.a.createElement("div",{className:"d-flex align-items-center",id:"num-of-views-icon"},o.a.createElement(p.a,{icon:d.q,style:{color:"gray"}}))))," ",o.a.createElement("div",{className:""},this.props.numOfViews),o.a.createElement("div",{className:"d-flex align-items-center"},o.a.createElement(u.a,{title:"総ダウンロード数"},o.a.createElement("div",{className:"d-flex align-items-center ml-3",id:"num-of-downloads-icon"},o.a.createElement(p.a,{icon:d.l,style:{color:"gray"}}))))," ",o.a.createElement("div",{className:""},this.props.numOfDownloads)),o.a.createElement("div",{className:"col-12 col-sm-5 col-md-4 col-lg-3 col-xl-2 info-description px-0 mt-2 mt-sm-0"},o.a.createElement(u.a,{title:"公式ブログで確認"},o.a.createElement("a",{href:this.props.officialUrl,className:this.props.group,target:"_blank",rel:"noreferrer",id:"officialLink"},o.a.createElement("div",{className:"download-official-a"},o.a.createElement(p.a,{icon:d.p})," ",e)))))))}}var g=Object(c.withRouter)(h),b=s("./node_modules/file-saver/dist/FileSaver.min.js"),f=s("./node_modules/react-masonry-component/lib/index.js"),E=s.n(f),w=s("./src/components/molecules/ImageCard.jsx"),v=s("./node_modules/react-cookie/es6/index.js"),x=s("./src/components/contexts/DomContext.jsx");var y=Object(v.b)(e=>{const{group:t,images:s,blogViewURL:l,incrementNumOfDownloads:i,putDownload:d,mode:p,blogUrl:u,officialUrl:h,writer:g,blogCt:f,blogTitle:v,groupID:y,cookies:N}=e,[j,O]=Object(a.useState)(!1),[k,D]=Object(a.useState)(Array(s.length).fill(!1)),[_,C]=Object(a.useState)(!1),S=Object(x.d)(),I=Object(c.useLocation)(),U=()=>{let e=[];for(const[t,a]of s.entries())"view"===p||"download"===p&&(e.push(new Image),e[t].onload=setTimeout(()=>{const s=L(a.order);document.getElementById(s).style.backgroundImage="url("+e[t].src+")"},m.k),e[t].src=a.src.originals)};Object(a.useEffect)(()=>{U()},[]),Object(a.useEffect)(()=>{U()},[p]);const L=e=>`blog-image-${y}_${f}_${e}_${I.key}`;if("view"===p){const e={itemSelector:".grid-item",transitionDuration:0,stagger:0};return o.a.createElement("div",{className:"container"},n.u&&o.a.createElement("div",{className:"alert alert-success mb-1",role:"alert",style:{borderRadius:"1rem",fontSize:14}},"画像を長押しして保存をおこなってください"),o.a.createElement(E.a,{options:e,className:"mt-3 image-list-in-blog-view"},s.map(({src:e,url:s,order:a,isFavorite:l,width:i,height:r},c)=>o.a.createElement("div",{key:a,className:"grid-item col-12 col-sm-6 my-2 my-sm-3 px-0 px-sm-2"},o.a.createElement(w.a,{groupID:y,group:t,blogCt:f,blogTitle:v,src:e,url:s,blogUrl:u,officialUrl:h,writer:g,imgID:L(a),order:a,isFavorite:l,width:i,height:r,shouldLoadOriginal:!0,didMountImage:()=>{const e=L(a),t=document.getElementById(e);Object(n.b)(t,()=>d(a))}})))))}if("download"===p)return o.a.createElement(o.a.Fragment,null,o.a.createElement("form",{onSubmit:e=>(e=>{if(e.preventDefault(),k.includes(!0)){let e=[];for(const[t,s]of k.entries())s&&e.push(t);r.a.post(l,e,{headers:{"X-CSRFToken":N.get("csrftoken")},responseType:"blob"}).then(t=>{S({type:"OPEN_GLOBAL_MODAL",globalModalId:"ImageDownloadedModal"}),O(!1),D(Array(s.length).fill(!1)),C(!1);const a=new Blob([t.data],{type:t.data.type}),o=t.headers["content-disposition"].match(/filename="(.*)"/)[1];Object(b.saveAs)(a,o),i(-1,e.length)})}else _||C(!0)})(e)},o.a.createElement("div",{className:"col-md-3 col-lg-2 ml-auto",style:{width:200}},o.a.createElement("div",{className:"custom-control custom-checkbox"},o.a.createElement("input",{name:"allCheck",type:"checkbox",className:"custom-control-input",id:"allCheck",checked:j,onChange:e=>(e=>{const t=e.target.checked;O(t),D([...k].fill(t))})(e)}),o.a.createElement("label",{className:"custom-control-label",htmlFor:"allCheck"},"すべて選択"))),o.a.createElement("div",{className:"container my-4"},o.a.createElement("div",{className:"row text-center"},s.map((e,s)=>o.a.createElement("div",{key:s,className:"col-6 col-md-4 col-xl-3 mb-5"},o.a.createElement("div",{style:{cursor:"pointer"},onClick:()=>(e=>{const t=[...k];t[e]=!t[e],D(t)})(e.order)},o.a.createElement("div",{className:t},o.a.createElement("div",{className:"thumbnail img-thumbnail mx-auto "+(k[e.order]?"checked":""),id:L(e.order),style:{background:`-webkit-image-set( url(${e.src["250x"]}) 1x, url(${e.src["500x"]}) 2x )`,backgroundSize:"cover",backgroundPosition:"center"}},o.a.createElement("input",{className:"save_img_checkbox",type:"checkbox",onChange:e=>(e=>{const t=e.target,s=t.checked,a=[...k];a[t.name]=s,D(a)})(e),name:e.order,checked:k[e.order]})))))))),_&&o.a.createElement("div",{className:"alert alert-danger py-2 mb-5 mt-0",role:"alert",style:{borderRadius:"1rem"}},"画像を選択してください。"),o.a.createElement("div",{className:"mx-auto mb-5",style:{width:150}},o.a.createElement("button",{type:"submit",className:"gradient-btn "+t,style:{width:150}},o.a.createElement("b",null,"保存")))))}),N=s("./src/components/molecules/Loader.jsx"),j=s("./src/components/atoms/NotFound.jsx"),O=s("./src/components/molecules/info/BlogSearchListInfo.jsx"),k=s("./src/components/atoms/AdSense.jsx"),D=s("./src/components/templates/ViewTemplate.jsx"),_=s("./src/components/contexts/AuthContext.jsx");function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class S extends D.a{constructor(e){super(e),this.changeMode=e=>{e!==this.state.mode&&("view"===e||"download"===e?this.setState({mode:e}):this.setState({mode:""}))},this.isRender=Object(n.d)(e.history,e.match.params.groupID,e.match.params.blogCt),this.initBlogState={mode:"view"},this.state=Object.assign(this.initState,this.initBlogState)}putView(){r.a.put(this.blogViewURL,{action:"view",key:this.state.VIEW_KEY},{headers:{"X-CSRFToken":this.props.cookies.get("csrftoken")}}).then(e=>{"success"==e.data.status&&this.incrementNumOfViews()})}putDownload(e){r.a.put(Object(n.a)(m.d,"image/",this.state.groupID,this.state.blogCt,e.toString()),{action:"download",key:this.state.DOWNLOAD_KEY},{headers:{"X-CSRFToken":this.props.cookies.get("csrftoken")}}).then(e=>{"success"==e.data.status&&this.incrementNumOfDownloads()})}updateMetaVerView(e,t,s){this.isRender&&("success"===e?Object(n.H)({title:`${t}(${s})｜ブログ詳細`,description:`${s}のブログ「${t}」です。`}):"get_image_failed"===e?Object(n.H)({title:"Not Found Image",description:""}):"blog_not_found"===e?Object(n.H)({title:"Not Found Blog",description:""}):"accepted"===e&&Object(n.H)({title:"画像取得中",description:""}))}componentDidMount(){this.isRender&&super.componentDidMount()}componentDidUpdate(e,t){if(t.status!==this.state.status&&"success"===this.state.status&&this.state.VIEW_KEY){const e=`${this.state.groupID}_${this.state.blogCt}_${this.props.location.key}`;this.props.domState.accessedBlogs.includes(e)||(this.putView(),this.props.domDispatch({type:"ACCESS_TO_BLOG",blogID:e}))}const s=this.props.match.params.groupID,a=e.match.params.groupID,o=this.props.match.params.blogCt,l=e.match.params.blogCt;a===s&&l===o||(this.initBlogState={mode:"view",groupID:s,blogCt:o,group:Object(n.o)(s)},this.setState(Object.assign(this.initState,this.initBlogState)),this.blogViewURL=Object(n.a)(m.d,"blog/",s,o),this.getBlog()),super.componentDidUpdate(e,t)}componentWillUnmount(){super.componentWillUnmount(),this.isRender=!1}render(){let e;return""===this.state.status?e=o.a.createElement(N.c,{type:"horizontal"}):"success"===this.state.status?e=this.state.images.length>0?o.a.createElement(y,{group:this.state.group,images:this.state.images,blogViewURL:this.blogViewURL,incrementNumOfDownloads:(e,t)=>this.incrementNumOfDownloads(e,t),putDownload:e=>this.putDownload(e),mode:this.state.mode,blogUrl:this.state.url,officialUrl:this.state.officialUrl,writer:this.state.writer,blogCt:this.state.blogCt,blogTitle:this.state.title,groupID:this.state.groupID}):o.a.createElement(j.c,{type:"image",margin:!0}):"accepted"===this.state.status?e=o.a.createElement(N.a,{progress:this.state.progress,loadingImageUrl:m.q}):"blog_not_found"!==this.state.status&&"get_image_failed"!==this.state.status||(e=o.a.createElement(j.c,{type:"blogFailed",margin:!0})),o.a.createElement(o.a.Fragment,null,this.isRender&&o.a.createElement("div",{className:"container mt-3 text-muted"},o.a.createElement(l.a,{title:"ブログ詳細",type:"blogView",mode:this.state.mode,changeMode:e=>this.changeMode(e)}),"blog_not_found"!==this.state.status?o.a.createElement(g,{group:this.state.group,title:this.state.title,writer:this.state.writer,postDate:this.state.postDate,officialUrl:this.state.officialUrl,numOfViews:this.state.numOfViews,numOfDownloads:this.state.numOfDownloads}):o.a.createElement(O.a,{group:this.state.group,title:this.state.title,numOfHit:0}),o.a.createElement("div",{className:"container mt-4"},n.w?o.a.createElement(k.b,null):o.a.createElement(k.a,{height:"100px"})),e))}}t.default=Object(c.withRouter)(Object(v.b)(e=>o.a.createElement(x.b.Consumer,null,t=>o.a.createElement(x.a.Consumer,null,s=>o.a.createElement(_.a.Consumer,null,a=>o.a.createElement(S,C({},e,{domState:t,domDispatch:s,authState:a})))))))}}]);