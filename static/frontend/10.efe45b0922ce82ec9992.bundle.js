(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"./src/components/molecules/info/BlogSearchListInfo.jsx":function(e,t,s){"use strict";var a=s("./node_modules/react/index.js"),o=s.n(a),n=s("./src/components/modules/utils.js");class i extends o.a.Component{constructor(e){super(e)}render(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"card otapick-card2 "+(n.w?"smp mb-3 ":n.u?"mb-3 mt-1 ":"my-4 ")+this.props.group},o.a.createElement("div",{className:"card-body px-4 px-sm-5 py-4"},o.a.createElement("div",{className:"row mx-2 justify-content-between"},o.a.createElement("h2",{className:"my-auto d-flex align-items-center"},this.props.title?this.props.title:" ")),o.a.createElement("hr",{className:"info-hr"}),o.a.createElement("div",{className:"row justify-content-between"},o.a.createElement("div",{className:"col-12 col-md-6 col-lg-7 col-xl-8"},o.a.createElement("div",{className:"info-description my-1 my-sm-0"},"検索結果（",o.a.createElement("b",null,this.props.numOfHit),"件）"))))))}}t.a=i},"./src/components/templates/BlogViewTemplate.jsx":function(e,t,s){"use strict";s.r(t);var a=s("./node_modules/react/index.js"),o=s.n(a),n=s("./src/components/molecules/Headline.jsx"),i=s("./src/components/modules/utils.js"),l=s("./node_modules/axios/index.js"),r=s.n(l),c=s("./node_modules/react-router-dom/esm/react-router-dom.js"),m=s("./src/components/modules/env.js"),d=s("./node_modules/@fortawesome/free-solid-svg-icons/index.es.js"),u=s("./node_modules/@fortawesome/react-fontawesome/index.es.js"),p=s("./src/components/atoms/TooltipComponent.jsx");class g extends o.a.Component{constructor(e){super(e)}render(){let e;return Object.values(m.m).forEach(t=>{t.key===this.props.group&&(e=t.domain)}),o.a.createElement("div",{className:"card otapick-card2 "+(i.w?"smp mb-3 ":i.u?"mb-3 mt-1 ":"my-4 ")+this.props.group},o.a.createElement("div",{className:"card-body px-4 px-sm-5 py-4"},this.props.title.length>0?this.props.title.length>50?o.a.createElement("h3",{className:"smaller"},this.props.title):o.a.createElement("h3",null,this.props.title):o.a.createElement("h3",null," "),o.a.createElement("div",{className:"row download-info mt-3"},Object.keys(this.props.writer).length?o.a.createElement(c.Link,{to:this.props.writer.url.blogs,className:"info-description ml-3 small "+this.props.group},this.props.writer.name?this.props.writer.name:" "):o.a.createElement(c.Link,{to:"",className:"info-description ml-3 small "+this.props.group}," "),o.a.createElement("p",{className:"info-description ml-3 small mb-0"},this.props.postDate)),o.a.createElement("hr",{className:"info-hr"}),o.a.createElement("div",{className:"row ml-2 ml-sm-3"},o.a.createElement("div",{className:"row col-12 col-sm-7 col-md-8 col-lg-9 col-xl-10 info-description"},o.a.createElement("div",{className:"d-flex align-items-center"},o.a.createElement(p.a,{title:"閲覧数"},o.a.createElement("div",{className:"d-flex align-items-center",id:"num-of-views-icon"},o.a.createElement(u.a,{icon:d.q,style:{color:"gray"}}))))," ",o.a.createElement("div",{className:""},this.props.numOfViews),o.a.createElement("div",{className:"d-flex align-items-center"},o.a.createElement(p.a,{title:"総ダウンロード数"},o.a.createElement("div",{className:"d-flex align-items-center ml-3",id:"num-of-downloads-icon"},o.a.createElement(u.a,{icon:d.l,style:{color:"gray"}}))))," ",o.a.createElement("div",{className:""},this.props.numOfDownloads)),o.a.createElement("div",{className:"col-12 col-sm-5 col-md-4 col-lg-3 col-xl-2 info-description px-0 mt-2 mt-sm-0"},o.a.createElement(p.a,{title:"公式ブログで確認"},o.a.createElement("a",{href:this.props.officialUrl,className:this.props.group,target:"_blank",rel:"noreferrer",id:"officialLink"},o.a.createElement("div",{className:"download-official-a"},o.a.createElement(u.a,{icon:d.p})," ",e)))))))}}var h=Object(c.withRouter)(g),b=s("./node_modules/file-saver/dist/FileSaver.min.js"),f=s("./node_modules/react-masonry-component/lib/index.js"),w=s.n(f),O=s("./src/components/molecules/ImageCard.jsx"),E=s("./node_modules/react-cookie/es6/index.js"),j=s("./src/components/contexts/DomContext.jsx");var _=Object(E.b)(e=>{const{group:t,images:s,blogViewURL:n,incrementNumOfDownloads:l,putDownload:d,mode:u,blogUrl:p,officialUrl:g,writer:h,blogCt:f,blogTitle:E,groupID:_,cookies:v}=e,[N,D]=Object(a.useState)(!1),[y,x]=Object(a.useState)(Array(s.length).fill(!1)),[S,V]=Object(a.useState)(!1),I=Object(j.d)(),k=Object(c.useLocation)(),C=()=>{let e=[];for(const[t,a]of s.entries())"view"===u||"download"===u&&(e.push(new Image),e[t].onload=setTimeout(()=>{const s=U(a.order);document.getElementById(s).style.backgroundImage="url("+e[t].src+")"},m.j),e[t].src=a.src.originals)};Object(a.useEffect)(()=>{C()},[]),Object(a.useEffect)(()=>{C()},[u]);const U=e=>`blog-image-${_}_${f}_${e}_${k.key}`;if("view"===u){const e={itemSelector:".grid-item",transitionDuration:0,stagger:0};return o.a.createElement("div",{className:"container"},i.u&&o.a.createElement("div",{className:"alert alert-success mb-1",role:"alert",style:{borderRadius:"1rem",fontSize:14}},"画像を長押しして保存をおこなってください"),o.a.createElement(w.a,{options:e,className:"mt-3 image-list-in-blog-view"},s.map(({src:e,url:s,order:a,isFavorite:n,width:l,height:r},c)=>o.a.createElement("div",{key:a,className:"grid-item col-12 col-sm-6 my-2 my-sm-3 px-0 px-sm-2"},o.a.createElement(O.a,{groupId:_,groupKey:t,blogCt:f,blogTitle:E,srcCollection:e,url:s,blogUrl:p,officialUrl:g,writer:h,priorityImageId:U(a),order:a,initIsFavorite:n,width:l,height:r,shouldLoadOriginal:!0,didMountImage:()=>{const e=U(a),t=document.getElementById(e);Object(i.b)(t,()=>d(a))}})))))}if("download"===u)return o.a.createElement(o.a.Fragment,null,o.a.createElement("form",{onSubmit:e=>(e=>{if(e.preventDefault(),y.includes(!0)){let e=[];for(const[t,s]of y.entries())s&&e.push(t);r.a.post(n,e,{headers:{"X-CSRFToken":v.get("csrftoken")},responseType:"blob"}).then(t=>{I({type:"OPEN_GLOBAL_MODAL",globalModalId:"ImageDownloadedModal"}),D(!1),x(Array(s.length).fill(!1)),V(!1);const a=new Blob([t.data],{type:t.data.type}),o=t.headers["content-disposition"].match(/filename="(.*)"/)[1];Object(b.saveAs)(a,o),l(-1,e.length)})}else S||V(!0)})(e)},o.a.createElement("div",{className:"col-md-3 col-lg-2 ml-auto",style:{width:200}},o.a.createElement("div",{className:"custom-control custom-checkbox"},o.a.createElement("input",{name:"allCheck",type:"checkbox",className:"custom-control-input",id:"allCheck",checked:N,onChange:e=>(e=>{const t=e.target.checked;D(t),x([...y].fill(t))})(e)}),o.a.createElement("label",{className:"custom-control-label",htmlFor:"allCheck"},"すべて選択"))),o.a.createElement("div",{className:"container my-4"},o.a.createElement("div",{className:"row text-center"},s.map((e,s)=>o.a.createElement("div",{key:s,className:"col-6 col-md-4 col-xl-3 mb-5"},o.a.createElement("div",{style:{cursor:"pointer"},onClick:()=>(e=>{const t=[...y];t[e]=!t[e],x(t)})(e.order)},o.a.createElement("div",{className:t},o.a.createElement("div",{className:"thumbnail img-thumbnail mx-auto "+(y[e.order]?"checked":""),id:U(e.order),style:{background:`-webkit-image-set( url(${e.src["250x"]}) 1x, url(${e.src["500x"]}) 2x )`,backgroundSize:"cover",backgroundPosition:"center"}},o.a.createElement("input",{className:"save_img_checkbox",type:"checkbox",onChange:e=>(e=>{const t=e.target,s=t.checked,a=[...y];a[t.name]=s,x(a)})(e),name:e.order,checked:y[e.order]})))))))),S&&o.a.createElement("div",{className:"alert alert-danger py-2 mb-5 mt-0",role:"alert",style:{borderRadius:"1rem"}},"画像を選択してください。"),o.a.createElement("div",{className:"mx-auto mb-5",style:{width:150}},o.a.createElement("button",{type:"submit",className:"gradient-btn "+t,style:{width:150}},o.a.createElement("b",null,"保存")))))}),v=s("./src/components/molecules/Loader.jsx"),N=s("./src/components/atoms/NotFound.jsx"),D=s("./src/components/molecules/info/BlogSearchListInfo.jsx"),y=(s("./src/components/atoms/Adsense.jsx"),s("./src/components/templates/ViewTemplate.jsx")),x=s("./src/components/contexts/AuthContext.jsx");function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}class V extends y.a{constructor(e){super(e),this.changeMode=e=>{e!==this.state.mode&&("view"===e||"download"===e?this.setState({mode:e}):this.setState({mode:""}))},this.isRender=Object(i.d)(e.history,e.match.params.groupID,e.match.params.blogCt),this.initBlogState={mode:"view"},this.state=Object.assign(this.initState,this.initBlogState)}putView(){r.a.put(this.blogViewURL,{action:"view",key:this.state.VIEW_KEY},{headers:{"X-CSRFToken":this.props.cookies.get("csrftoken")}}).then(e=>{"success"==e.data.status&&this.incrementNumOfViews()})}putDownload(e){r.a.put(Object(i.a)(m.b,"image/",this.state.groupID,this.state.blogCt,e.toString()),{action:"download",key:this.state.DOWNLOAD_KEY},{headers:{"X-CSRFToken":this.props.cookies.get("csrftoken")}}).then(e=>{"success"==e.data.status&&this.incrementNumOfDownloads()})}updateMetaVerView(e,t,s){this.isRender&&("success"===e?Object(i.H)({title:`${t}(${s})｜ブログ詳細`,description:`${s}のブログ「${t}」です。`}):"get_image_failed"===e?Object(i.H)({title:"Not Found Image",description:""}):"blog_not_found"===e?Object(i.H)({title:"Not Found Blog",description:""}):"accepted"===e&&Object(i.H)({title:"画像取得中",description:""}))}componentDidMount(){this.isRender&&super.componentDidMount()}componentDidUpdate(e,t){if(t.status!==this.state.status&&"success"===this.state.status&&this.state.VIEW_KEY){const e=`${this.state.groupID}_${this.state.blogCt}_${this.props.location.key}`;this.props.domState.accessedBlogs.includes(e)||(this.putView(),this.props.domDispatch({type:"ACCESS_TO_BLOG",blogID:e}))}const s=this.props.match.params.groupID,a=e.match.params.groupID,o=this.props.match.params.blogCt,n=e.match.params.blogCt;a===s&&n===o||(this.initBlogState={mode:"view",groupID:s,blogCt:o,group:Object(i.o)(s)},this.setState(Object.assign(this.initState,this.initBlogState)),this.blogViewURL=Object(i.a)(m.b,"blog/",s,o),this.getBlog()),super.componentDidUpdate(e,t)}componentWillUnmount(){super.componentWillUnmount(),this.isRender=!1}render(){let e;return""===this.state.status?e=o.a.createElement(v.c,{type:"horizontal"}):"success"===this.state.status?e=this.state.images.length>0?o.a.createElement(_,{group:this.state.group,images:this.state.images,blogViewURL:this.blogViewURL,incrementNumOfDownloads:(e,t)=>this.incrementNumOfDownloads(e,t),putDownload:e=>this.putDownload(e),mode:this.state.mode,blogUrl:this.state.url,officialUrl:this.state.officialUrl,writer:this.state.writer,blogCt:this.state.blogCt,blogTitle:this.state.title,groupID:this.state.groupID}):o.a.createElement(N.c,{type:"image",margin:!0}):"accepted"===this.state.status?e=o.a.createElement(v.a,{progress:this.state.progress,loadingImageUrl:m.p}):"blog_not_found"!==this.state.status&&"get_image_failed"!==this.state.status||(e=o.a.createElement(N.c,{type:"blogFailed",margin:!0})),o.a.createElement(o.a.Fragment,null,this.isRender&&o.a.createElement("div",{className:"container mt-3 text-muted"},o.a.createElement(n.a,{title:"ブログ詳細",type:"blogView",mode:this.state.mode,changeMode:e=>this.changeMode(e)}),"blog_not_found"!==this.state.status?o.a.createElement(h,{group:this.state.group,title:this.state.title,writer:this.state.writer,postDate:this.state.postDate,officialUrl:this.state.officialUrl,numOfViews:this.state.numOfViews,numOfDownloads:this.state.numOfDownloads}):o.a.createElement(D.a,{group:this.state.group,title:this.state.title,numOfHit:0}),e))}}t.default=Object(c.withRouter)(Object(E.b)(e=>o.a.createElement(j.b.Consumer,null,t=>o.a.createElement(j.a.Consumer,null,s=>o.a.createElement(x.a.Consumer,null,a=>o.a.createElement(V,S({},e,{domState:t,domDispatch:s,authState:a})))))))},"./src/components/templates/ViewTemplate.jsx":function(e,t,s){"use strict";s.d(t,"c",(function(){return u})),s.d(t,"e",(function(){return p})),s.d(t,"b",(function(){return g})),s.d(t,"d",(function(){return h}));var a=s("./node_modules/react/index.js"),o=s.n(a),n=s("./node_modules/axios/index.js"),i=s.n(n),l=s("./src/components/modules/utils.js"),r=s("./src/components/modules/env.js"),c=s("./node_modules/react-router/esm/react-router.js"),m=s("./src/components/modules/axios.js");class d extends o.a.Component{constructor(e){super(e);const t=e.match.params.groupID,s=e.match.params.blogCt;this.initState={group:Object(l.o)(t),groupID:t,blogCt:s,title:"",postDate:"",writer:{},numOfViews:0,numOfDownloads:0,officialUrl:"",url:"",images:[],status:"",progress:0,loadingImageUrl:"",VIEW_KEY:"",DOWNLOAD_KEY:""},this.state=this.initState,this.blogViewURL=Object(l.a)(r.b,"blog/",this.state.groupID,this.state.blogCt),this.incrementNumOfViews=this.incrementNumOfViews.bind(this),this.incrementNumOfDownloads=this.incrementNumOfDownloads.bind(this)}getBlog(){setTimeout(()=>{i.a.get(this.blogViewURL).then(e=>{let t={};this.state.status||"blog_not_found"===e.data.status||(t={title:e.data.title,postDate:e.data.post_date,writer:e.data.writer,numOfViews:e.data.num_of_views,numOfDownloads:e.data.num_of_downloads,officialUrl:e.data.official_url,url:e.data.url}),"success"===e.data.status?void 0!==this.props.order&&e.data.images.length<=this.props.order?(this.setState(Object.assign({status:"get_image_failed"},t)),this.updateMetaVerView("get_image_failed")):(this.setState(Object.assign({images:e.data.images.map(e=>Object(l.f)(e)),status:"success",VIEW_KEY:e.data.VIEW_KEY,DOWNLOAD_KEY:e.data.DOWNLOAD_KEY},t)),this.updateMetaVerView("success",t.title,t.writer.name)):"start_download"===e.data.status||"downloading"===e.data.status?(this.setState(Object.assign({progress:e.data.progress,loadingImageUrl:e.data.loading_image,status:"accepted"},t)),this.updateMetaVerView("accepted")):"blog_not_found"===e.data.status?(this.setState({status:"blog_not_found",title:"ブログが見つかりませんでした。"}),this.updateMetaVerView("blog_not_found")):"get_image_failed"===e.data.status&&(this.setState(Object.assign({status:"get_image_failed"},t)),this.updateMetaVerView("get_image_failed"))}).catch(e=>{console.error(e)}).finally(()=>{Object(l.s)(this.props.location.pathname)})},r.j)}incrementNumOfViews(e=-1){e<0?this.setState(e=>({numOfViews:e.numOfViews+1})):this.setState(t=>{let s=t.images;return s.length>e&&(s[Number(e)].numOfViews+=1),{images:s}})}incrementNumOfDownloads(e=-1,t=1){e<0?this.setState(e=>({numOfDownloads:e.numOfDownloads+t})):this.setState(s=>{let a=s.images;return a.length>e&&(a[Number(e)].numOfDownloads+=t),{images:a}})}componentDidMount(){this.getBlog()}componentDidUpdate(e,t){t.status!==this.state.status&&"accepted"===this.state.status&&(this.reqCount=0,this.intervalReqID=setInterval(()=>{this.reqCount++<=20?this.getBlog():(this.setState({status:"get_image_failed"}),clearInterval(this.intervalReqID))},1e3)),t.status!==this.state.status&&"accepted"===t.status&&clearInterval(this.intervalReqID)}componentWillUnmount(){clearInterval(this.intervalReqID)}}t.a=d;const u=()=>{var e,t,s;const o=Object(c.n)(),[n]=Object(a.useState)(null==o||null===(e=o.params)||void 0===e?void 0:e.groupId),[i]=Object(a.useState)(null==o||null===(t=o.params)||void 0===t?void 0:t.blogCt),[r]=Object(a.useState)(null==o||null===(s=o.params)||void 0===s?void 0:s.order),[m]=Object(a.useState)(Object(l.o)(n));return{groupId:n,blogCt:i,order:r,groupKey:m}},p=(e,t,s)=>{const[o]=Object(a.useState)(Object(l.a)(r.b,"image/",e,t,s)),[n]=Object(a.useState)(Object(l.a)(r.b,"blog/",e,t));return{imageViewUrl:o,blogViewUrl:n}},g=(e,t,s)=>{const o=Object(c.l)(),[n,i]=Object(a.useState)(),[r,d]=Object(a.useState)(),[u,p]=Object(a.useState)(""),[g,h]=Object(a.useState)(""),[b,f]=Object(a.useState)(""),[w,O]=Object(a.useState)(!1);return Object(m.a)(e,"get",{thenCallback:e=>{let a={};u||"blog_not_found"===e.data.status||(a=Object(l.g)({...e.data})),"success"===e.data.status?void 0!==t&&e.data.images.length<=t?(p("get_image_failed"),d(a),s("get_image_failed")):(d(a),i(e.data.images.map(e=>Object(l.g)(e))),p("success"),h(e.data.VIEW_KEY),f(e.data.DOWNLOAD_KEY),s("success",a.title,a.writer.name)):"blog_not_found"===e.data.status&&(p("blog_not_found"),s("blog_not_found"))},finallyCallback:()=>{Object(l.s)(o.pathname)},shouldRequestDidMount:!0}),Object(a.useEffect)(()=>{!w&&void 0!==n&&void 0!==r&&"string"==typeof u&&u.length>0&&"string"==typeof g&&g.length>0&&"string"==typeof b&&b.length>0&&O(!0)},[n,r,u,g,b]),[n,i,r,u,g,b,w]},h=(e,t)=>{const[s,o]=Object(a.useState)(0),[n,i]=Object(a.useState)(0);return{numOfViewsOnlyBlog:s,incrementNumOfViews:(a=-1)=>{if(a<0)o(s+1);else{let s=[...e];s.length>a&&(s[Number(a)].numOfViews+=1,t(s))}},numOfDownloadsOnlyBlog:n,incrementNumOfDownloads:(s=-1,a=1)=>{if(s<0)i(n+a);else{let o=[...e];o.length>s&&(o[Number(s)].numOfDownloads+=a,t(o))}}}}}}]);